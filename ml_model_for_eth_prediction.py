# -*- coding: utf-8 -*-
"""ML model for ETH prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Qya9ahTKQ_0OEmo4hyZsk65ScTqqmw5z
"""

#description : ML price prediction model (ETH)

#modules
import pandas as pd 
import numpy as np
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split

#data 
from google.colab import files 
files.upload()

#display the dats
df = pd.read_csv('ETH-USD.csv')
df

#creating a variable for x number of days 
projection = 14
#new column for prediction 
df['Prediction'] = df[['Close']].shift(-projection)
df

#create a indipendant data set (X) 
X = np.array(df[['Close']])
#removing last 14 rows 
X = X[:-projection]
print(X)

#create the dependent data set(y)
y = df['Prediction'].values 
y = y[:-projection]
print(y)

#splitting data into 85% training and 15% testing data sets 
x_train, x_test, y_train, y_test = train_test_split(X, y, test_size = .15)

#create and train the model
linReg = LinearRegression()
#train the model 
linReg.fit(x_train, y_train)

#test the model using score
linReg_confidence = linReg.score(x_test, y_test)
print('Linear regression confidence:', linReg_confidence)

#most recent 14 days
x_projection = np.array(df[['Close']])[-projection:]
print(x_projection)

#print the linear regression models prediction for the next 14 days 
linReg_prediction = linReg.predict(x_projection)
print(linReg_prediction)

#If the model is right then the price of eth in 14 days from 2022-03-31 should be 3294.82 considering current is 3302.1